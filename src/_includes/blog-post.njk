{% extends 'page.njk' %}
{% block content %}

<h1>{{title}}</h1>
<p>by {{authors[author].name}}, {{authors[author].organization}}</p>
<p>{{ page.date | readableDate }}</p>

{%- set tags = tags | filterTags -%}
{%- if tags.length > 0 -%}
<p>
  <span style="font-size: smaller; margin-right: 3px;">Tags:</span>
  {%- for tag in tags -%}
  <a href="/blog/tags/{{tag}}" class="tag">{{ tag }}</a>
  {%- endfor -%}
</p>
{%- endif -%}
{{content | safe}}
<div class="blognav">
  {%set postlist = collections.post %}
  {%set nextPost = page | nextPost(postlist) %}
  {%set prevPost = page | prevPost(postlist) %}
{%-if prevPost -%}<a href="{{prevPost['url']}}">Previous: {{prevPost['title']}}</a>{%- endif -%}
{%-if nextPost -%}<a href="{{nextPost['url']}}">Next: {{nextPost['title']}}</a>{%- endif -%}
</div>

<aside class="related-posts">
  <h2>Related Posts</h2>
  <ul>
  {%- for tag in tags -%}
    {%- set postlist = collections[tag] | filterSelfOut(page) -%}
    {%- if postlist.length > 0 -%}
      {%- for post in postlist  -%}
        <li><a href="{{ post.url }}">{{ post.data.title }}</a></li>
      {%- endfor -%}
    {%- endif -%}
  {%- endfor -%}
  </ul>
</aside>

{% endblock %}
